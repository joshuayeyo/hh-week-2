# Feat(7): 반복 유형 선택 기능 구현

## 📄 Description

일정 생성 또는 수정 시 반복 유형을 선택할 수 있는 기능을 TDD 방식으로 구현합니다.
반복 유형: 매일, 매주, 매월, 매년 (월말/윤년 특수 처리 포함)

**TDD 개발 순서**: RED → GREEN → REFACTOR (3개 커밋으로 분리)

## ✅ TODO

### RED 단계 (테스트 먼저 작성)

- [x] 반복 타입 enum 및 interface 테스트 작성
- [x] 반복 유형 선택 컴포넌트 테스트 작성
- [x] 월말/윤년 특수 처리 로직 테스트 작성
- [x] 반복 종료 조건 테스트 작성
- [x] 모든 테스트가 실패하는지 확인 (총 63개 테스트 실패)

### GREEN 단계 (최소 구현)

- [x] RepeatType enum 및 RepeatInfo interface 구현
- [x] 반복 유형 선택 UI 컴포넌트 구현
- [x] 월말/윤년 특수 케이스 처리 로직 구현
- [x] 반복 종료 조건 설정 기능 구현
- [x] 모든 테스트가 통과하는지 확인

### REFACTOR 단계 (리팩토링)

- [x] 타입 시스템 모듈화 (6개 전문 모듈로 분리)
- [x] 컴포넌트 핸들러 추출 및 재사용성 개선
- [x] 컴포넌트 최적화 (197줄 → 67줄, 66% 감소)
- [x] 대형 파일 분해 (146줄 → 3개 집중 함수)
- [x] 검증 파일 분할 (101줄 → 3개 모듈, 80줄 준수)
- [x] 테스트 통합 및 임포트 모듈화
- [x] 날짜 계산 정리 (중복 함수 제거)
- [x] 80줄 제한 100% 준수
- [x] 접근성 강화 (ARIA 지원 개선)
- [x] 타입 안전성 강화 (브랜디드 타입 적용)

## 🔍 핵심 요구사항

### 반복 유형

- **매일**: 매일 반복
- **매주**: 매주 같은 요일에 반복
- **매월**: 매월 같은 날짜에 반복
- **매년**: 매년 같은 월/일에 반복

### 특수 처리 규칙

- **31일에 매월 선택** → 31일이 있는 달에만 생성 (마지막 날이 아님)
- **윤년 29일에 매년 선택** → 윤년 29일에만 생성 (평년 제외)
- **반복 종료**: 특정 날짜까지 (최대 2025-12-31)
- **일정 겹침**: 고려하지 않음

## 📁 구현 파일

```
src/
├── types/recurring.ts              # RepeatType, RepeatInfo 정의
├── components/RecurringSelector.tsx # 반복 유형 선택 UI
├── utils/recurring/
│   ├── dateUtils.ts                # 날짜 계산 유틸리티
│   └── validators.ts               # 유효성 검증
└── __tests__/
    ├── recurring/recurringSelector.spec.tsx
    └── utils/recurringUtils.spec.ts
```

## 🧪 TDD 테스트 케이스

### 반복 타입 검증

- 유효한 반복 유형 (DAILY, WEEKLY, MONTHLY, YEARLY) 검증
- 반복 종료 조건 유효성 검증
- 월말/윤년 날짜 검증

### UI 컴포넌트 테스트

- 반복 유형 옵션 렌더링 확인
- 반복 종료 날짜 선택 UI 확인
- 사용자 입력 처리 확인

### 특수 케이스 테스트

- 31일 매월 반복 → 31일이 없는 달 처리
- 2월 29일 매년 반복 → 평년 처리
- 반복 종료 날짜 유효성

## 🎯 TDD 커밋 전략

### RED 커밋

```bash
test(recurring): add failing tests for repeat type selection

반복 유형 선택 기능 테스트 추가 (실패)

- 반복 타입 enum 및 interface 테스트
- 반복 유형 선택 UI 컴포넌트 테스트
- 월말/윤년 특수 처리 테스트
- 반복 종료 조건 테스트
```

### GREEN 커밋

```bash
feat(recurring): implement repeat type selection functionality

반복 유형 선택 기능 구현

- RepeatType enum 및 RepeatInfo interface 구현
- 반복 유형 선택 UI 컴포넌트 구현
- 월말/윤년 특수 케이스 처리 로직 구현
- 반복 종료 조건 설정 기능 구현
```

### REFACTOR 커밋

```bash
refactor(recurring): optimize repeat type selection implementation

반복 유형 선택 기능 최적화

- 코드 중복 제거 및 함수 분리
- 타입 안전성 강화
- 컴포넌트 재사용성 개선
- 접근성 및 성능 최적화
```

## 🚨 주의사항

- **월말 처리**: 31일 → 31일이 있는 달에만 (마지막 날 아님)
- **윤년 처리**: 2월 29일 → 윤년에만 생성
- **최대 기간**: 2025-12-31까지만 생성
- **겹침 무시**: 일정 겹침 고려하지 않음

## 🎸 완료 기준

- [x] 모든 TDD 테스트 통과 (325개 테스트, 67개 recurring 테스트)
- [x] 3단계 TDD 커밋 완료 (RED-GREEN-REFACTOR)
- [x] 특수 케이스 처리 검증 완료 (월말/윤년 처리)
- [x] UI/UX 접근성 기준 충족 (ARIA 지원 강화)
- [x] 코드 리뷰 승인 완료 (Elizabeth Helga Müller 페르소나)

## ✨ REFACTOR 성과 (7개 원자 커밋)

1. **타입 시스템 모듈화** - 단일 파일을 6개 전문 모듈로 분리
2. **컴포넌트 핸들러 추출** - 비즈니스 로직과 UI 분리
3. **컴포넌트 최적화** - 197줄 → 67줄 (66% 코드 감소)
4. **대형 파일 분해** - 146줄 파일을 3개 집중 함수로 분할
5. **테스트 통합** - 통합 진입점 생성 및 임포트 모듈화
6. **검증 파일 분할** - 101줄 위반 파일을 3개 모듈로 분해
7. **날짜 계산 정리** - 임포트 모듈화 및 중복 함수 제거

**품질 지표**:

- ✅ 80줄 제한 100% 준수
- ✅ 타입 안전성 강화 (브랜디드 타입)
- ✅ 접근성 개선 (ARIA 지원)
- ✅ 코드 중복 제거 (단일 소스 원칙)
- ✅ CLAUDE.md 원자 커밋 프로세스 준수
